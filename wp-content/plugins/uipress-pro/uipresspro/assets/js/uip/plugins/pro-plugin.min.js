const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n,defineAsyncComponent=window.uipress.defineAsyncComponent,uipVersion=window.uipress.proVersion;export default{components:{GoogleAnalytics:defineAsyncComponent(()=>import(`./google-analytics.min.js?ver=${uipVersion}`)),WooCommerce:defineAsyncComponent(()=>import(`./woocommerce.min.js?ver=${uipVersion}`)),Matomo:defineAsyncComponent(()=>import(`./matomo-analytics.min.js?ver=${uipVersion}`)),Fathom:defineAsyncComponent(()=>import(`./fathom-analytics.min.js?ver=${uipVersion}`))},data:()=>({rg:!0,sp:!1,ul:window.uipressroute,userKey:"",validating:!1,userData:{},fa:0,strings:{thankYou:__("Thank you for installing UiPress 3 Pro","uipress-pro"),thankYouMessage:__("For pro features to work correctly, please add your pro licence below","uipress-pro"),register:__("Register","uipress-pro")}}),inject:["uiTemplate"],watch:{},mounted(){this.getData()},methods:{async getData(){if("production"==this.uiTemplate.display||"prod"==this.uiTemplate.display)return void(this.rg=!0);let t=new FormData;t.append("action","uip_get_pro_app_data"),t.append("security",uip_ajax.security);const i=await this.sendServerRequest(uip_ajax.ajax_url,t);if(i.error)this.uipApp.notifications.notify(i.message,"","error",!0);else{if(!i.uip_pro)return this.rg=!1,void this.register();this.userData=i.uip_pro,setTimeout(this.consume,24e4),this.uiTemplate.proActivated=!0}},register(){this.sp=!0},async saveData(t,i){const e="instance_id"in i&&i.instance_id;let s=new FormData;s.append("action","uip_save_uip_pro_data"),s.append("security",uip_ajax.security),s.append("key",t),s.append("instance",e),s.append("multisite",this.uipApp.data.options.multisite),s.append("networkActivated",this.uipApp.data.options.networkActivated),s.append("primarySite",this.uipApp.data.options.primarySite);const a=await this.sendServerRequest(uip_ajax.ajax_url,s);a.error&&this.uipApp.notifications.notify(a.message,"","error",!0)},removeData(){let t=new FormData;t.append("action","uip_remove_uip_pro_data"),t.append("security",uip_ajax.security),this.sendServerRequest(uip_ajax.ajax_url,t)},async consume(){const t=this.uipApp.data.options.domain;let i="";i+="?k="+this.userData.key,i+="&d="+t,i+="&instance="+this.userData.instance;let e=this.ul+"validate/"+i,s=new FormData;const a=await this.sendServerRequest(e,s);if(!(a instanceof Error||"false"==a.state))return"true"==a.state?(this.saveUserPreference("uipfa",2,!1),this.sp=!1,this.rg=!0,void(this.uiTemplate.proActivated=!0)):(this.rg=!0,void setTimeout(this.consume,3e5));this.handleRegisterErrror()},async handleRegisterErrror(){const t=await this.getUserPreference("uipfa");t?(this.fa=parseInt(t),this.fa=isNaN(this.fa)?2:this.fa+1):this.fa=2,this.fa<12?this.saveUserPreference("uipfa",this.fa,!1):this.fa>=12&&(this.sp=!0,this.rg=!1,this.saveUserPreference("uipfa",2,!1),this.removeData(),this.uiTemplate.proActivated=!1)},async onSubmit(){this.validating=!0;let t=this.uipApp.data.options.domain,i="";i+="?k="+this.userKey,i+="&d="+t,i+="&instance=";let e=this.ul+"validate/"+i,s=new FormData;const a=await this.sendServerRequest(e,s);return a.error?(this.validating=!1,void this.uipApp.notifications.notify(a.message,"","error",!0)):a instanceof Error?(this.validating=!1,void this.uipApp.notifications.notify(__("Check failed","uipress-pro"),__("Unable to contact licencing servers. Please try again later","uipress-pro"),"error",!0)):"false"==a.state?(this.validating=!1,void this.uipApp.notifications.notify(a.message,"","error",!0)):"true"==a.state?(this.sp=!1,this.validating=!1,this.rg=!0,this.uipApp.notifications.notify(__("Thank you!","uipress-pro"),__("Your key is valid and you can now use pro features","uipress-pro"),"success",!0),this.saveData(this.userKey,a),this.saveUserPreference("uipfa",2,!1),void(this.uiTemplate.proActivated=!0)):(this.validating=!1,void this.uipApp.notifications.notify(__("Check failed","uipress-pro"),__("Something went wrong. Please try again later","uipress-pro"),"error",!0))}},template:'\n\t<div id="notification-drop" class="uip-dark-mode">\n  \n\t\t<div v-if="sp" class="uip-notification uip-padding-s uip-fade-in" style="width:auto;">\n\t\t\t<div class="uip-flex uip-gap-xs">\n\t\t\t\t<div class="uip-max-w-300">\n\t\t\t\t\t<div class="uip-text-bold uip-text-inverse uip-margin-bottom-xs">{{strings.thankYou}}</div>\n\t\t\t\t\t<div class="uip-text-s uip-text-normal uip-margin-bottom-s">{{strings.thankYouMessage}}</div>\n\t\t\t\t\t\n\t\t\t\t\t<form class="uip-flex uip-flex-row uip-gap-xs" @submit.prevent="onSubmit()">\n\t\t\t\t\t\t<input class="uip-input uip-flex-grow" type="text" v-model="userKey" placeholder="xxxx-xxxx-xxxx-xxxx" required>\n\t\t\t\t\t\t<label class="uip-button-primary uip-body-font uip-min-w-60 uip-flex uip-flex-middle uip-flex-row">\n\t\t\t\t\t\t\t<input v-show="!validating" type="submit" class="uip-blank-input uip-text-emphasis" :value="strings.register"/>\n\t\t\t\t\t\t\t<div><span v-show="validating" class="uip-load-spinner" ></span></div>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t\t<div class="uip-position-absolute uip-right-0 uip-top-0 uip-padding-s">\n\t\t\t\t\t<div class="uip-icon uip-margin-left-xs uip-cursor-pointer uip-link-default" @click="sp = false">close</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n    \n\t</div>\n  \n  \x3c!--Pro Plugins--\x3e\n  <template v-if="rg">\n    <GoogleAnalytics/>\n    <WooCommerce/>\n    <Matomo/>\n    <Fathom/>\n  </template>'};