const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{props:{display:String,name:String,block:Object},data(){return{loading:!1,search:"",plugins:[],page:0,totalFound:0,totalPages:0,wpVersion:this.uipApp.data.dynamicOptions.wpversion.value,hasSearched:!1,image:{pos:{}},strings:{placeholder:__("Input placeholder...","uipress-pro"),update:__("Update","uipress-pro"),install:__("Install","uipress-pro"),details:__("Details","uipress-pro"),newVersion:__("New verasion","uipress-pro"),watchOut:__("Watch out","uipress-pro"),watchOutDescription:__("This plugin has not been tested with your platform version","uipress-pro"),nothingFound:__("No plugins found for query","uipress-pro"),results:__("Results","uipress-pro"),activate:__("Activate","uipress-pro"),rating:__("Rating","uipress-pro"),lastUpdated:__("Last updated","uipress-pro"),downloads:__("Downloads","uipress-pro"),activeInstalls:__("Active installs","uipress-pro"),requiresWP:__("Requires wp","uipress-pro"),requiresPHP:__("Requires PHP","uipress-pro"),orHigher:__("or higher","uipress-pro"),images:__("Images","uipress-pro")}}},computed:{returnPlaceHolder(){const i=this.get_block_option(this.block,"block","inputPlaceHolder",!0);return i?this.isObject(i)?i.string?i.string:"":i:""},returnPlugins(){return this.plugins}},methods:{mouseMoveHandler(i){const e=document.getElementById("uip-image-scroller"),t=i.clientX-this.image.pos.x,n=i.clientY-this.image.pos.y;e.scrollTop=this.image.pos.top-n,e.scrollLeft=this.image.pos.left-t},mouseUpHandler(){const i=document.getElementById("uip-image-scroller");i.removeEventListener("mousemove",this.mouseMoveHandler),i.removeEventListener("mouseup",this.mouseUpHandler),i.style.cursor="grab",i.style.removeProperty("user-select")},mouseDownHandler(i){const e=document.getElementById("uip-image-scroller");this.image.pos={left:e.scrollLeft,top:e.scrollTop,x:i.clientX,y:i.clientY},e.style.cursor="grabbing",e.style.userSelect="none",e.addEventListener("mousemove",this.mouseMoveHandler),e.addEventListener("mouseup",this.mouseUpHandler)},async getPluginupdates(){let i=new FormData;i.append("action","uip_get_plugin_updates"),i.append("security",uip_ajax.security);const e=await this.sendServerRequest(uip_ajax.ajax_url,i);e.error?this.uipApp.notifications.notify(e.message,"","error",!0):(this.loading=!1,this.updates=e.updates)},async searchPlugins(){if(""==this.search)return void(this.plugins=[]);this.hasSearched=!1,this.loading=!0;let i=new FormData;i.append("action","uip_search_directory"),i.append("security",uip_ajax.security),i.append("search",this.search),i.append("page",this.page);const e=await this.sendServerRequest(uip_ajax.ajax_url,i);e.error?this.uipApp.notifications.notify(e.message,"","error",!0):(this.loading=!1,this.hasSearched=!0,this.plugins=e.plugins,this.totalFound=e.totalFound,this.totalPages=e.totalPages)},returnRating(i){const e=i>0?(i/20).toFixed(1):0;let t="";for(let i=0;i<5;i++)t+=e-i>=1?'<span class="uip-icon-star"></span>':e-i>=.5?'<span class="uip-icon">star_half</span>':'<span class="uip-icon">star</span>';return t},async getPluginupdates(){let i=new FormData;i.append("action","uip_get_plugin_updates"),i.append("security",uip_ajax.security);const e=await this.sendServerRequest(uip_ajax.ajax_url,i);e.error?this.uipApp.notifications.notify(e.message,"","error",!0):(this.loading=!1,this.updates=e.updates)},goBack(){this.page>1&&(this.page=this.page-1,this.searchPlugins())},goForward(){this.page<this.totalPages&&(this.page=this.page+1,this.searchPlugins())},async installPlugin(i){i[0].loading=!0;let e=i[0].download_link,t=new FormData;if(t.append("action","uip_install_plugin"),t.append("security",uip_ajax.security),t.append("downloadLink",e),(await this.sendServerRequest(uip_ajax.ajax_url,t,!0)).error)return;i[0].loading=!1,i[0].activateAvailable=!0;const n=i[0].name+" "+__("was succesfully installed","uipress-pro");this.uipApp.notifications.notify(__("Success","uipress-pro"),n,"success",!0)},async activatePlugin(i){i[0].loading=!0;let e=i[0].slug,t=new FormData;t.append("action","uip_activate_plugin"),t.append("security",uip_ajax.security),t.append("slug",e);const n=await this.sendServerRequest(uip_ajax.ajax_url,t,!0);if(n.error)return void this.uipApp.notifications.notify(n.message,"","error",!0);i[0].loading=!1,i[0].finished=!0,i[0].activateAvailable=!1;const s=i[0].name+" "+__("was succesfully activated. You may need to refresh the page for any menu links to update","uipress-pro");this.uipApp.notifications.notify(__("Success","uipress-pro"),s,"success",!0)},formatResults(i){return new Intl.NumberFormat(this.uipApp.data.options.locale).format(i)},formatToReadable(i){let e=i.split(" ")[0],t=(i.split(" ")[1],i.split(" ")[2],new Date(Date.parse(e)));return this.timeSince(t,new Date)},isInstalled(i){return!!JSON.stringify(this.uipApp.data.options.installedPlugins).includes(i)},isActive(i){return!!JSON.stringify(this.uipApp.data.options.activePlugins).includes(i)},timeSince(i,e){const t=Math.floor((e-i)/1e3),n=[{name:"year",seconds:31536e3},{name:"month",seconds:2592e3},{name:"day",seconds:86400},{name:"hour",seconds:3600},{name:"minute",seconds:60}];for(const{name:i,seconds:e}of n){const n=Math.floor(t/e);if(n>=1)return`${n} ${i}${n>1?"s":""}`}return`${t} second${1!==t?"s":""}`}},template:'\n    <div>\n      <div class="uip-flex uip-flex-column uip-row-gap-s uip-max-h-viewport">\n        \n        <div class="uip-flex uip-padding-xxs uip-border uip-border-round uip-search-block uip-flex-grow uip-gap-xs uip-flex-center uip-search-input">\n          <span class="uip-icon uip-text-muted ">search</span>\n          <input v-model="search" class="uip-blank-input uip-flex-grow uip-text-s" type="text" :placeholder="returnPlaceHolder" autofocus="" v-on:keyup.enter="searchPlugins">\n          <span class="uip-icon uip-text-muted  uip-text-muted">keyboard_return</span>\n        </div>\n        \n        <div v-if="loading" class="uip-padding-m uip-flex uip-flex-center uip-flex-middle"><loading-chart></loading-chart></div>\n        <div v-else-if="returnPlugins.length > 0" class="uip-grid-col-4 uip-grid-min-width-medium uip-grid-gap-m uip-padding-xxs uip-max-h-viewport uip-overflow-hidden uip-scrollbar">\n        \n          <div class="uip-flex uip-flex-center uip-gap-xs uip-text-muted" v-if="returnPlugins.length < 1 && search != \'\' && !loading && hasSearched">\n            <span>{{strings.nothingFound}}</span>\n          </div>\n        \n          <component is="style" scoped>\n            .plugin-list-enter-active,\n            .plugin-list-leave-active {\n              transition: all 0.5s ease;\n            }\n            .plugin-list-enter-from,\n            .plugin-list-leave-to {\n              opacity: 0;\n              transform: translateX(30px);\n            }\n          </component>\n        \n          <TransitionGroup name="plugin-list">\n          \n            <div v-for="(item, index) in returnPlugins" class="uip-flex uip-flex-column uip-row-gap-xs uip-border-round " :key="item.name">\n              <div class="uip-flex uip-flex-row uip-gap-s uip-flex-no-wrap uip-flex-center uip-cursor-pointer" @click="item.open = !item.open">\n              \n                <img :src="Object.values(item.icons)[0]" class="uip-border uip-border-circle uip-w-28 uip-ratio-1-1"> \n                \n                <div class=" uip-flex-grow">\n                  <div class=" uip-line-height-1 uip-overflow-hidden uip-no-wrap uip-text-ellipsis uip-margin-bottom-xxs" v-html="item.name"></div>\n                  \n                  <div class="uip-flex uip-flex-row uip-no-wrap uip-text-m uip-text-muted" v-html="returnRating(item.rating)"></div>\n                  \n                </div>\n                \n              </div>\n              \n              <template v-if="item.open">\n              \n                <div class="uip-text-muted uip-text-s uip-scale-in-center" v-html="item.short_description">\n                </div>\n                \n                \n                \n                <div class="uip-flex uip-flex-row uip-flex-center uip-gap-xs uip-scale-in-center">\n                \n                  <template v-if="!item.finished">\n                  \n                    <div v-if="!item.activateAvailable && !isInstalled(item.slug)" class="">\n                      <uip-save-button :saving="item.loading" size="small"\n                      :saveFunction="installPlugin" :saveArg="[item, index]" :buttonText="strings.install">\n                      </uip-save-button>\n                    </div>\n                    \n                    <div v-if="item.activateAvailable || (!isActive(item.slug) && isInstalled(item.slug))" class="">\n                      <uip-save-button :saving="item.loading" size="small" :buttonSecondary="true"\n                      :saveFunction="activatePlugin" :saveArg="[item, index]" :buttonText="strings.activate">\n                      </uip-save-button>\n                    </div>\n                    \n                  </template>\n                  \n                  \n                    <button @click="$refs[\'detailsModal\'+index][0].open()" class="uip-button-default uip-flex uip-gap-xxs uip-no-underline uip-background-grey uip-link-default">\n                      <span class="uip-text-s uip-line-height-1">{{strings.details}}</span>\n                    </button>\n                    \n                    <uipModal :ref="\'detailsModal\'+index">\n                      \n                        <div class="uip-flex uip-flex-column uip-row-gap-m uip-max-width-100p uip-overflow-hidden uip-scrollbar-hidden  uip-max-w-700" style="overflow-y:auto">\n                      \n                          <div class="uip-padding-m uip-padding-remove-bottom uip-flex uip-flex-column uip-row-gap-m">\n                            <div class="uip-flex uip-flex-row uip-gap-s uip-flex-no-wrap uip-flex-center uip-cursor-pointer">\n                            \n                              <img :src="Object.values(item.icons)[0]" class="uip-border uip-border-circle uip-w-50 uip-ratio-1-1"> \n                              \n                              <div class=" uip-flex-grow">\n                                <div class="uip-text-l" v-html="item.name"></div>\n                                <a class="uip-text-muted uip-link-muted uip-no-underline" :href="item.homepage" target="_BLANK">{{item.author.replace(/<[^>]*>?/gm, \'\')}}</a>\n                              </div>\n                              \n                            </div>\n                            \n                            \x3c!--Meta--\x3e\n                            <div class="uip-flex uip-flex-row uip-gap-xs">\n                            \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-text-center">{{strings.rating}}</div>\n                                <span class="uip-flex uip-flex-row uip-no-wrap uip-text-m uip-text-muted" v-html="returnRating(item.rating)"></span>\n                              </div>\n                              \n                              <div class="uip-border-right"></div>\n                              \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-line-height-1 uip-text-center">{{strings.lastUpdated}}</div>\n                                <span class="uip-text-m uip-text-muted">{{formatToReadable(item.last_updated)}}</span>\n                              </div>\n                              \n                              <div class="uip-border-right"></div>\n                              \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-line-height-1 uip-text-center">{{strings.activeInstalls}}</div>\n                                <span class="uip-text-m uip-text-muted uip-text-bold">{{formatResults(item.active_installs)}}+</span>\n                              </div>\n                              \n                              <div class="uip-border-right"></div>\n                              \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-line-height-1 uip-text-center">{{strings.downloads}}</div>\n                                <span class="uip-text-m uip-text-muted uip-text-bold">{{formatResults(item.downloaded)}}</span>\n                              </div>\n                              \n                              <div class="uip-border-right"></div>\n                              \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-line-height-1 uip-text-center">{{strings.requiresWP}}</div>\n                                <span class="uip-text-m uip-text-muted uip-text-bold">{{item.requires}} {{strings.orHigher}}</span>\n                              </div>\n                              \n                              <div class="uip-border-right"></div>\n                              \n                              <div class="uip-flex uip-flex-column uip-row-gap-xxxs uip-flex-center">\n                                <div class="uip-text-muted uip-text-s uip-line-height-1 uip-text-center">{{strings.requiresPHP}}</div>\n                                <span class="uip-text-m uip-text-muted uip-text-bold">{{item.requires_php}} {{strings.orHigher}}</span>\n                              </div>\n                              \n                              \n                            </div>\n                            \x3c!--End Meta--\x3e\n                            \n                            <div v-if="!item.finished" class="uip-flex uip-flex-row uip-gap-s">\n                            \n                                <div v-if="!item.activateAvailable && !isInstalled(item.slug)" class="">\n                                  <uip-save-button :saving="item.loading" size="small"\n                                  :saveFunction="installPlugin" :saveArg="[item, index]" :buttonText="strings.install">\n                                  </uip-save-button>\n                                </div>\n                                \n                                <div v-if="item.activateAvailable || (!isActive(item.slug) && isInstalled(item.slug))" class="">\n                                  <uip-save-button :saving="item.loading" size="small" :buttonSecondary="true"\n                                  :saveFunction="activatePlugin" :saveArg="[item, index]" :buttonText="strings.activate">\n                                  </uip-save-button>\n                                </div>\n                                \n                            </div>\n                          </div>\n                          \n                          \n                          <div class="uip-padding-m uip-padding-remove-top uip-padding-remove-bottom uip-max-h-500 uip-overflow-auto uip-scrollbar">\n                          \n                            \x3c!-- Description --\x3e\n                            <div v-if="!item.showFull" class="uip-fade-bottom uip-cursor-pointer uip-max-h-150 uip-overflow-hidden" @click="item.showFull = true">\n                              <div class="uip-text-muted uip-text-s uip-scale-in-center" v-html="item.description">\n                              </div>\n                            </div>\n                            \n                            <div v-if="item.showFull" class="uip-text-muted uip-text-s uip-scale-in-center uip-max-w-100p uip-scale-in" v-html="item.description">\n                            </div>\n                            \x3c!--End description --\x3e\n                          \n                          </div>\n                          \n                         \n                          \n                          \n                          <div class="uip-padding-left-m uip-padding-right-m uip-text-bold">{{strings.images}}</div>\n                          \n                          <div id="uip-image-scroller" class="uip-max-w-100p uip-overflow-auto uip-scrollbar-hidden uip-flex uip-padding-bottom-m" @mousedown="mouseDownHandler" @mouseup="mouseUpHandler">\n                          \n                            <template v-for="img in item.screenshots">\n                              <img :src="img.src" :alt="img.caption" class="uip-max-h-200 uip-border-round uip-border uip-margin-left-m uip-remove-drag">\n                            </template>\n                          \n                          </div>\n                          \n                        \n                        \n                        </div>\n                      \n                    </uipModal>\n                    \n                </div>\n                \n                \n                \n                <div v-if="wpVersion > item.tested" class="uip-background-orange-wash uip-padding-xs uip-border-round uip-scale-in-center">\n                  <div class="uip-text-bold">{{strings.watchOut}}</div>\n                  <div class="uip-text-muted uip-text-s">{{strings.watchOutDescription}}</div>\n                </div>\n              \n              </template>\n              \n            </div>\n          \n          </TransitionGroup>\n        </div>\n        \n        <div v-if="hasSearched" class="uip-flex uip-flex-between uip-flex-center uip-w-100p">\n          <div class="uip-padding-xxs uip-post-count">{{formatResults(totalFound)}} {{strings.results}}</div>\n          <div class="uip-flex uip-gap-xs uip-padding-xs" v-if="totalPages > 1">\n            <button @click="goBack" class="uip-button-default uip-icon uip-nav-button">chevron_left</button>\n            <button @click="goForward" v-if="page < totalPages" class="uip-button-default uip-icon uip-nav-button">chevron_right</button>\n          </div>\n        </div>\n        \n      </div>\n    </div>'};