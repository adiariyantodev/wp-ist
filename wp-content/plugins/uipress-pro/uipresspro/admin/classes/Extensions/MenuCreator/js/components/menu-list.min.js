const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{data:()=>({menus:[],page:1,totalPages:0,totalFound:0,loading:!1,initialLoading:!0,selectAll:!1,search:"",strings:{adminMenus:__("Admin menus","uipress-pro"),newMenu:__("New menu","uipress-pro"),edit:__("Edit","uipress-pro"),duplicate:__("Duplicate","uipress-pro"),delete:__("Delete","uipress-pro"),status:__("Status","uipress-pro"),forRoles:__("Roles and users","uipress-pro"),excludes:__("Excludes","uipress-pro"),modified:__("Modified","uipress-pro"),name:__("Name","uipress-pro"),type:__("Type","uipress-pro"),active:__("Active","uipress-pro"),draft:__("Draft","uipress-pro"),results:__("results","uipress-pro"),searchMenus:__("Search menus","uipress-pro"),templateDuplicated:__("Template duplicated","uipress-pro"),templateDeleted:__("Template deleted","uipress-pro"),deleteSelected:__("Delete selected","uipress-pro"),menuCreator:__("Menu Builder","uipress-pro"),newMenu:__("New menu","uipress-pro"),welcomeTotheUibuilder:__("It's a little quiet!","uipress-pro"),welcomeMeta:__("Create a new menu to get started with menu creator","uipress-pro"),viewDocs:__("View docs","uipress-pro"),editTemplate:__("Edit","uipress-pro"),duplicateAdminMenu:__("Duplicate","uipress-pro"),export:__("Export","uipress-pro"),importTemplate:__("Import","uipress-pro"),deleteTemplate:__("Delete","uipress-pro"),version:__("version","uipress-pro"),tools:__("Tools","uipress-pro"),settings:__("Site settings","uipress-pro"),phpErrorLog:__("PHP error log","uipress-pro"),roleEditor:__("Role editor","uipress-pro"),pro:__("pro","uipress-pro"),uiTemplate:__("Ui Template","uipress-pro"),adminPage:__("Admin page","uipress-pro"),loginPage:__("Login page","uipress-pro"),frontEndToolbar:__("Frontend toolbar","uipress-pro"),setupWizard:__("Setup wizard","uipress-pro"),exportSelected:__("Export selected","uipress-pro"),uploadMenus:__("Import menus","uipress-pro")},activeSwitchOptions:{false:{value:!1,label:__("Draft","uipress-lite")},true:{value:!0,label:__("Active","uipress-lite")}},activeFilter:"all",tabletabs:[{name:"all",label:__("All menus","uipress-lite")},{name:!0,label:__("Active","uipress-lite")},{name:!1,label:__("Drafts","uipress-lite")}]}),async created(){await this.getMenuList()},computed:{returnTableData(){const e=this.search.toLowerCase(),i="all"==this.activeFilter?[!1,!0]:[this.activeFilter];return this.menus.filter(t=>t.name.toLowerCase().includes(e)&&i.includes(t.status))}},methods:{async getMenuList(){if(this.loading)return;this.loading=!0;let e=new FormData;e.append("action","uipress_get_menus"),e.append("security",this.AjaxSecurity);const i=await this.sendServerRequest(this.AjaxUrl,e);this.loading=!1,this.initialLoading=!1,i.error?this.uipApp.notifications.notify(i.message,"","error",!0):(this.menus=i.menus,this.totalPages=i.totalPages,this.totalFound=i.totalFound)},async duplicateAdminMenu(e){let i=new FormData;i.append("action","uip_duplicate_admin_menu"),i.append("security",this.AjaxSecurity),i.append("id",e);const t=await this.sendServerRequest(this.AjaxUrl,i);t.error?this.uipApp.notifications.notify(t.message,"","error",!0):(this.uipApp.notifications.notify(this.strings.templateDuplicated,"","success",!0),this.getMenuList())},async deleteAdminMenu(e){e=Array.isArray(e)?e:[e];let i=new FormData;i.append("action","uip_delete_admin_menus"),i.append("security",this.AjaxSecurity),i.append("menuids",e);const t=await this.sendServerRequest(this.AjaxUrl,i);t.error?this.uipApp.notifications.notify(t.message,"","error",!0):(this.uipApp.notifications.notify(t.message,"","success",!0),this.getMenuList())},async exportTemplate(e){let i=new FormData;i.append("action","uipress_get_menu"),i.append("security",this.AjaxSecurity),i.append("id",e);const t=await this.sendServerRequest(this.AjaxUrl,i);if(t.error)return void this.uipApp.notifications.notify(t.message,"","error",!0);let n={};n.uipmenus=[t.menuOptions],this.exportToJson(n)},exportToJson(e){let i=JSON.stringify(e),t=new Date,n=String(t.getDate()).padStart(2,"0"),s="UiPress menu export-"+(String(t.getMonth()+1).padStart(2,"0")+"-"+n+"-"+t.getFullYear())+".json",p="data:text/json;charset=utf-8,"+encodeURIComponent(i),r=this.$refs.menuexport;r.setAttribute("href",p),r.setAttribute("download",s),r.click(),this.uipApp.notifications.notify(__("Menu exported","uipress-lite"),"","success",!0)},async createNewMenu(){const e=this.uipApp.notifications.notify(__("Creating new menu","uipress-pro"),"","default",!1,!0);let i=new FormData;i.append("action","uip_create_new_admin_menu"),i.append("security",this.AjaxSecurity);const t=(await this.sendServerRequest(this.AjaxUrl,i)).id;await this.getMenuList();const n=this.menus.findIndex(e=>e.id===t),s=this.menus[n];this.editAdminMenu(s,n),this.uipApp.notifications.remove(e)},returnActiveIndicatorStyle(e){let i="border:1px solid var(--uip-color-green)";return"draft"==e&&(i="border:1px solid var(--uip-color-orange)"),i},async confirmDelete(e){await this.$refs.confirm.show({title:__("Delete admin menu","uipress-pro"),message:__("Deleted menus can't be recovered","uipress-pro"),okButton:__("Delete","uipress-pro")})&&this.deleteAdminMenu(e)},editAdminMenu(e,i){this.$refs.menueditor.show(e,e=>{this.menus[i]={...e},this.menus[i].appliesTo=Array.isArray(e.for)?[...e.for]:[],this.saveMenu(this.menus[i],!0)})},async saveMenu(e,i){const t=JSON.stringify(e,(e,i)=>"true"===i?"uiptrue":!0===i?"uiptrue":"false"===i?"uipfalse":!1===i?"uipfalse":""===i?"uipblank":i);let n=new FormData;n.append("action","uipress_save_menu"),n.append("security",this.AjaxSecurity),n.append("menu",t);const s=await this.sendServerRequest(this.AjaxUrl,n);s.error?this.uipApp.notifications.notify(s.message,"","error",!0):i&&this.uipApp.notifications.notify(__("Menu saved","uipress-lite"),"","success",!0)},returnTabStyle(e){if(e.name==this.activeFilter)return{"border-bottom":"2px solid var(--uip-color-accent)"}},handleMenuRoleChange(e,i){i.for=[...e],i.appliesTo=[...e],this.saveMenu(i,!1)},returnRoleClone:e=>e?[...e]:[]},template:'\n\t\n\t\n  <div class="uip-flex uip-flex-column uip-h-100p uip-w-100p uip-background-muted" style="min-height:100dvh">\n  \n    \x3c!-- Toolbar --\x3e\n    <div class="uip-padding-s uip-background-default uip-border-bottom uip-border-bottom uip-flex uip-flex-between uip-position-relative">\n    \n      \x3c!-- Logo --\x3e\n      <div class="uip-flex uip-gap-xs uip-flex-center uip-border-rounder uip-background-muted uip-padding-xs uip-padding-top-xxs uip-padding-bottom-xxs">\n        <div class="uip-logo uip-w-18 uip-ratio-1-1"></div>\n        <div class="uip-text-bold">Menu Builder</div>\n      </div>\n            \n      \x3c!-- Global search --\x3e\n      <div class="uip-position-absolute uip-left-50p uip-translateX--50p uip-flex uip-flex-center uip-flex-middle">\n        <div class="uip-flex uip-background-muted uip-border-rounder uip-padding-xxs uip-flex-center uip-w-240 ">\n          <span class="uip-icon uip-text-muted uip-margin-right-xs">search</span>\n          <input class="uip-blank-input uip-flex-grow uip-text-s" type="search" v-model="search" :placeholder="strings.searchMenus" autofocus="">\n        </div>\n      </div>\n      \n      \x3c!-- Right actions --\x3e\n      <div class="uip-flex uip-gap-xs uip-flex-center">\n      \n        \n        \x3c!-- New template --\x3e\n        <div class="uip-button-primary uip-flex uip-flex-row uip-gap-xxs uip-flex-center uip-text-s" @click="createNewMenu()">\n          <span>{{strings.newMenu}}</span>\n        </div>\n      \n      </div>\n      \n    </div>\n    \x3c!-- End Toolbar--\x3e\n    \n    \x3c!-- Body--\x3e\n    <div class="uip-flex uip-flex-column uip-flex-center uip-padding-l">\n      \n      \x3c!-- Inner body --\x3e\n      <div class="uip-flex uip-flex-column uip-row-gap-m uip-w-1000 uip-max-w-100p">\n      \n        \x3c!-- Heading --\x3e\n        <div class="uip-flex uip-flex-between uip-flex-center">\n          <div class="uip-text-bold uip-text-xl uip-text-emphasis">{{ strings.adminMenus }}</div>\n        \n        </div>\n        \n        \n        \x3c!-- Filters --\x3e\n        <div class="uip-flex uip-gap-s">\n          <template v-for="item in tabletabs">\n            <a class="uip-padding-bottom-s" @click="activeFilter = item.name" \n            :class="item.name == this.activeFilter ? \'uip-text-bold uip-link-emphasis\' : \'uip-link-muted\'"\n            :style="returnTabStyle(item)">\n              {{item.label}}\n            </a>\n          </template>\n        </div>\n        \n        \n        <component is="style">\n          tr:hover {\n           box-shadow: var(--uip-box-shadow);\n          }\n          \n          tr:hover td:first-child{\n            border-radius:8px 0 0 8px;\n          }\n          tr:hover td:last-child{\n            border-radius:0 8px 8px 0;\n          }\n          .uip-template-table tr:first-child td:first-child {border-radius: 8px 0 0 0;}\n          .uip-template-table tr:first-child td:last-child {border-radius: 0 8px 0 0;}\n          .uip-template-table tr:last-child td:first-child {border-radius: 0 0 0 8px;}\n          .uip-template-table tr:last-child td:last-child {border-radius: 0 0 8px 0;}\n          .uip-template-table tr:last-child td {border: none !important;}\n        </component>\n        \n        \x3c!-- Table --\x3e\n        <TransitionGroup name="list" tag="table" class="uip-background-transparent uip-template-table" style="border-collapse: collapse;\n        border-spacing: 0;">\n        \n          <template v-for="(template, index) in returnTableData" :key="template.id">\n            \n          \n            <tr class="uip-link-default uip-border-rounder" @click="editAdminMenu(template, index)"\n            @contextmenu.prevent.stop="$refs[\'templatemenu-\'+index][0].show($event)">\n              \x3c!-- Template Title --\x3e\n              <td class="uip-border-bottom uip-padding-s uip-background-default">\n                <div class="uip-flex uip-flex-column uip-gap-xxs">\n                  \n                  <div class="uip-flex uip-gap-xs uip-flex-center">\n                  \n                    <div class="uip-text-bold">{{ template.name }}</div>\n                    \n                    <div class="uip-w-9 uip-ratio-1-1 uip-border-circle uip-opacity-70"\n                    :class="template.status ? \'uip-background-green\' : \'uip-background-orange\'" \n                    style="returnActiveIndicatorStyle(template.status)"></div>\n                    \n                  </div>\n                  \n                  \n                  <div class="uip-text-muted uip-text-s">{{ template.modified }}</div>\n                  \n                </div>\n              </td>\n              \n              \n              \x3c!-- Active state --\x3e\n              <td class="uip-border-bottom uip-padding-s uip-max-w-100 uip-background-default">\n                \n                <switch-select :options="activeSwitchOptions" \n                @click.stop\n                :activeValue="template.status" \n                :returnValue="(d)=>{template.status=d; saveMenu(template, false)}"/>\n                \n              </td>\n              \n              \n              \n              \x3c!-- Applies to --\x3e\n              <td  @click.stop class="uip-border-bottom uip-padding-s uip-max-w-160 uip-background-default">\n              \n                <user-role-select :selected="returnRoleClone(template.for)"\n                :placeHolder="strings.appliesTo"\n                :searchPlaceHolder="strings.searchUsersRoles"\n                :updateSelected="(d)=>{handleMenuRoleChange(d, template)}"/>\n                \n              </td>\n              \n              \n              \n              \x3c!-- Dropdown --\x3e\n              <td class="uip-border-bottom uip-padding-s uip-text-right uip-background-default">\n                \n                <a @click.prevent.stop="$refs[\'templatemenu-\'+index][0].show($event)"\n                class="uip-link-muted hover:uip-background-muted uip-border-rounder uip-padding-xxs uip-inline-flex uip-flex-centers uip-text-l">\n                  <span class="uip-icon">more_vert</span>\n                </a>\n                \n              </td>\n              \n            </tr>\n          \n          </template>\n        </TransitionGroup>\n        \x3c!-- End table --\x3e\n        \n        <template v-for="(template, index) in returnTableData" :key="template.id">\n          <ContextMenu :ref="\'templatemenu-\'+index">\n          \n            <div class="uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal uip-text-s">\n            \n              <a @click="editAdminMenu(template, index);$refs[\'templatemenu-\'+index][0].close()" \n              class="uip-link-muted uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                <span class="">{{strings.edit}}</span>\n                <span class="uip-icon">edit</span>\n              </a>\n            \n              <a class="uip-link-muted uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n              @click.prevent="duplicateAdminMenu(template.id);$refs[\'templatemenu-\'+index][0].close()">\n                <span class="">{{strings.duplicate}}</span>\n                <span class="uip-icon">content_copy</span>\n              </a>\n              \n              <a class="uip-link-muted uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n              @click.prevent="exportTemplate(template.id);$refs[\'templatemenu-\'+index][0].close()">\n                <span class="">{{strings.export}}</span>\n                <span class="uip-icon">file_download</span>\n              </a>\n              \n              <div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs"></div>\n              \n              <a class="uip-link-danger uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n              @click.prevent="confirmDelete(template.id);$refs[\'templatemenu-\'+index][0].close()">\n                <span class="">{{strings.delete}}</span>\n                <span class="uip-icon">delete</span>\n              </a>\n            \n            </div>\n          \n          </ContextMenu>\n        </template>\n        \n      </div>\n      \x3c!-- End inner body--\x3e\n      \n    </div>\n    \x3c!-- End body--\x3e\n    \n    <a class="uip-hidden" ref="menuexport"></a>\n    \n    <Confirm ref="confirm"/>\n    \n    <MenuEditor ref="menueditor"/>\n  \n    <Notify/>\n  </div>\n  '};