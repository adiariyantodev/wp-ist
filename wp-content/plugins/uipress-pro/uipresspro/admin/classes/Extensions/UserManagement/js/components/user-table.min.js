const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{data:()=>({loading:!0,tableData:[],tablePage:1,selectAll:!1,queryRunning:!1,users:[],query:{totalPages:0,totalUsers:0},strings:{user:__("User","uipress-pro"),name:__("Name","uipress-pro"),role:__("Role","uipress-pro"),registered:__("Registered","uipress-pro"),search:__("Search","uipress-pro"),roleFilter:__("Role filter","uipress-pro"),created:__("Created","uipress-pro"),date:__("Date","uipress-pro"),order:__("Order","uipress-pro"),ascending:__("Ascending","uipress-pro"),descending:__("Descending","uipress-pro"),perPage:__("Per page","uipress-pro"),filters:__("Filters","uipress-pro"),edit:__("Edit","uipress-pro"),delete:__("Delete","uipress-pro"),view:__("View","uipress-pro"),passwordReset:__("Password reset","uipress-pro"),message:__("Message","uipress-pro"),previous:__("Previous","uipress-pro"),next:__("Next","uipress-pro"),results:__("results","uipress-pro"),actions:__("Actions","uipress-pro"),clearSelection:__("Clear selection","uipress-lite")},tableFilters:{page:1,search:"",roles:[],dateCreated:{type:"on",date:""},activeGroup:"all"},tableOptions:{direction:"ASC",sortBy:"username",perPage:20},dateOptions:{on:{value:"on",label:__("On","uipress-pro")},before:{value:"before",label:__("Before","uipress-pro")},after:{value:"after",label:__("After","uipress-pro")}},ui:{offcanvas:{userPanelOpen:!1,messagePanelOpen:!1,newUserOpen:!1,batchRolePanelOpen:!1}}}),mounted(){this.getUserData(),this.uipApp.refreshTable=this.getUserData},watch:{tableFilters:{handler(e,s){this.getUserData()},deep:!0},tableOptions:{handler(e,s){this.getUserData()},deep:!0},selectAll:{handler(e,s){if(e)return this.selectAllUsers();this.deSelectAllUsers()}}},computed:{returnUsers(){return this.users},getTotalSelectedUsers(){return this.users.filter(e=>!0===e.selected).length},returnSelectedIDs(){return this.users.map(e=>{if(!0===e.selected)return e.user_id})},returnSelectedUsers(){return this.users.map(e=>{if(!0===e.selected)return e})}},methods:{selectAllUsers(){this.users.map(e=>e.selected=!0),this.selectAll=!0},deSelectAllUsers(){this.users.map(e=>e.selected=!1),this.selectAll=!1},async getUserData(){if(this.queryRunning)return;this.queryRunning=!0;let e=new FormData;e.append("action","uip_get_user_table_data"),e.append("security",this.AjaxSecurity),e.append("tablePage",this.tablePage),e.append("filters",JSON.stringify(this.tableFilters)),e.append("options",JSON.stringify(this.tableOptions));const s=await this.sendServerRequest(this.AjaxUrl,e);this.queryRunning=!1,this.users=s.tableData.users,this.query.totalPages=s.tableData.totalPages,this.query.totalUsers=s.tableData.totalFound,this.selectAll=!1},async deleteUser(e){const s=Array.isArray(e)?e:[e];if(!await this.$refs.Confirm.show({title:__("Delete user","uipress-pro"),message:__("Deleted users can't be recovered","uipress-pro"),okButton:__("Delete","uipress-pro")}))return;let n=new FormData;n.append("action","uip_delete_user"),n.append("security",this.AjaxSecurity),n.append("IDS",JSON.stringify(s));const i=await this.sendServerRequest(this.AjaxUrl,n);i.error?this.uipApp.notifications.notify(i.message,"","error",!0):(this.uipApp.notifications.notify(i.message,"","success",!0),this.getUserData())},async sendPasswordReset(e){const s=Array.isArray(e)?e:[e];let n=new FormData;n.append("action","uip_reset_password"),n.append("security",this.AjaxSecurity),n.append("IDS",JSON.stringify(s));const i=await this.sendServerRequest(this.AjaxUrl,n);i.error?this.uipApp.notifications.notify(i.message,"","error",!0):this.uipApp.notifications.notify(i.message,"","success",!0)},returnUserFullName(e){let s=[];return e.first_name&&s.push(e.first_name),e.last_name&&s.push(e.last_name),s.join(" ")}},template:' \n  \n  \n      <div class="uip-text-normal uip-flex uip-flex-column uip-row-gap-s">\n      \n        \x3c!--Filters--\x3e\n        \n        <div class="uip-flex uip-gap-xs uip-flex-center uip-flex-between">\n        \n          \x3c!--Search--\x3e\n          <div class="uip-background-muted uip-padding-xs uip-padding-top-xxs uip-padding-bottom-xxs uip-border-rounder uip-flex uip-flex-center uip-gap-xs">\n            <span class="uip-icon uip-text-muted">search</span>\n            <input class="uip-blank-input uip-flex-grow uip-text-s" :placeholder="strings.search" v-model="tableFilters.search">\n          </div>\n          \n          \n          <div class="uip-flex uip-gap-xs uip-flex-center">\n          \n          \n            \x3c!--Batch actions--\x3e\n            <dropdown pos="bottom right" ref="bulkActions">\n              \n              <template #trigger>\n              \n                <button :disabled="!getTotalSelectedUsers" class="uip-button-default uip-text-s">{{strings.actions}} ({{getTotalSelectedUsers}})</button>\n              \n              </template>\n              \n              <template #content>\n              \n                <div class="uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal uip-text-s">\n                \n                  <a @click="deSelectAllUsers();$refs.bulkActions.close()" \n                  class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                    <span class="">{{strings.clearSelection}}</span>\n                    <span class="uip-icon">backspace</span>\n                  </a>\n                \n                  <div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs"></div>\n                  \n                  <a @click="sendPasswordReset(returnSelectedIDs);$refs.bulkActions.close()" \n                  class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                    <span class="">{{strings.passwordReset}}</span>\n                    <span class="uip-icon">lock</span>\n                  </a>\n                  \n                  <a @click="uipApp.messageUser.show(returnSelectedUsers);$refs.bulkActions.close()" \n                  class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                    <span class="">{{strings.message}}</span>\n                    <span class="uip-icon">mail</span>\n                  </a>\n                  \n                  \n                  <div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs"></div>\n                  \n                  <a class="uip-link-danger uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n                  @click.prevent="deleteUser(returnSelectedIDs);$refs.bulkActions.close()">\n                    <span class="">{{strings.delete}}</span>\n                    <span class="uip-icon">delete</span>\n                  </a>\n                \n                </div>\n              \n              </template>\n            \n            </dropdown>\n          \n            \x3c!--User roles--\x3e\n            <div class="uip-w-200">\n              <UserRoleSelect :selected="tableFilters.roles"\n              :placeHolder="strings.roleFilter"\n              :roleOnly="true"\n              :searchPlaceHolder="strings.searchUsersRoles"\n              :updateSelected="(d)=>{tableFilters.roles=d}"/>\n            </div>\n            \n            \x3c!--General filters--\x3e\n            <dropdown pos="left top" ref="filtersDrop">\n            \n              <template #trigger>\n                <a class="uip-link-default hover:uip-background-grey uip-background-muted uip-border-rounder uip-icon uip-padding-xs">tune</a>\n              </template>\n              \n              <template #content>\n              \n                <div class="uip-padding-s uip-flex uip-flex-column uip-row-gap-s uip-w-260">\n                \n                  <div class="uip-flex uip-flex-between uip-flex-center">\n                    <div class="uip-text-emphasis uip-text-bold uip-text-s">{{strings.filters}}</div>\n                    <div @click="$refs.filtersDrop.close()" class="uip-flex uip-flex-center uip-flex-middle uip-padding-xxs uip-link-muted hover:uip-background-muted uip-border-rounder">\n                      <span class="uip-icon">close</span>\n                    </div>\n                  </div>\n                \n                  <div class="uip-grid-col-1-3 uip-padding-left-s">\n                \n                    <div class="uip-text-muted uip-flex uip-flex-center uip-text-s"><span>{{strings.created}}</span></div>\n                    <switch-select :options="dateOptions" style="width:160px"\n                    :activeValue="tableFilters.dateCreated.type" \n                    :returnValue="(d)=>(tableFilters.dateCreated.type=d)"/>\n                    \n                    <div class="uip-text-muted uip-flex uip-flex-center uip-text-s"><span>{{strings.date}}</span></div>\n                    <input class="uip-input uip-w-160" type="date" v-model="tableFilters.dateCreated.date">\n                  \n                  </div>\n                  \n                  <div class="uip-border-top"></div>\n                  \n                  <div class="uip-grid-col-1-3 uip-padding-left-s">\n                  \n                  \n                    <div class="uip-text-muted uip-flex uip-flex-center uip-text-s"><span>{{strings.order}}</span></div>\n                    <select v-model="tableOptions.direction" class="uip-input uip-w-160">\n                      <option value="ASC">{{strings.ascending}}</option>\n                      <option value="DESC">{{strings.descending}}</option>\n                    </select>\n                    \n                    <div class="uip-text-muted uip-flex uip-flex-center uip-text-s"><span>{{strings.perPage}}</span></div>\n                    <input v-model="tableOptions.perPage" class="uip-input uip-w-160" type="number">\n                    \n                    \n                  </div>\n                  \n                \n                </div>\n              \n              </template>\n            \n            </dropdown>\n          \n          </div>\n        \n        </div>\n      \n        <table class="uip-background-transparent uip-template-table" style="border-collapse: collapse;\n        border-spacing: 0;"> \n        \n          <thead>\n          \n            <tr>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top uip-text-left"><input type="checkbox" class="uip-checkbox" v-model="selectAll"></th>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top uip-text-muted uip-text-weight-normal uip-text-left">{{strings.user}}</th>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top uip-text-muted uip-text-weight-normal uip-text-left">{{strings.name}}</th>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top uip-text-muted uip-text-weight-normal uip-text-left">{{strings.role}}</th>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top uip-text-muted uip-text-weight-normal uip-text-left">{{strings.registered}}</th>\n              <th class="uip-padding-top-s uip-padding-bottom-s uip-border-bottom uip-border-top"></th>\n            </tr>  \n          \n          \n          </thead>\n        \n          <TransitionGroup name="list" tag="tbody">\n          \n            <tr v-for="(user, index) in returnUsers" :key="user.user_id" @contextmenu.prevent.stop="$refs[\'userMenu-\'+index][0].show($event)">\n              \n              \x3c!--Selector--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom uip-text-left">\n                <input class="uip-checkbox" :data-id="user.user_id" type="checkbox" v-model="user.selected">\n              </td>\n            \n              \x3c!--Username--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom uip-link-emphasis">\n                <div class="uip-flex uip-flex-center uip-gap-s" @click="$router.push(\'/users/\' + user.user_id + \'/\')">\n                  <img v-if="user.image" class="uip-w-28 uip-ratio-1-1 uip-border-circle" :src="user.image" />\n                  <div class="uip-flex uip-flex-column">\n                    <span class="uip-text-bold uip-text-emphasis">{{user.username}}</span>\n                    <span class="uip-text-muted uip-max-w-160 uip-overflow-hidden uip-text-ellipsis uip-no-wrap uip-text-s">{{user.user_email}}</span>\n                  </div>\n                </div>\n              </td>\n              \n              \x3c!--Name--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom">\n                <span class="">{{returnUserFullName(user)}}</span>\n              </td>\n              \n              \x3c!--Role--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom">\n                <div class="uip-flex uip-flex-wrap uip-gap-xs uip-row-gap-xxs">\n                \n                  <router-link :to="\'/roles/edit/\' + role" v-for="role in user.roles" \n                  class="uip-background-primary-wash uip-border-round uip-padding-left-xxs uip-padding-right-xxs uip-text-bold uip-link-default uip-no-underline uip-text-s">\n                    {{role}}\n                  </router-link>\n                  \n                </div>\n              </td>\n              \n              \x3c!--Created--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom">\n                <span class="">{{user.user_registered}}</span>\n              </td>\n              \n              \n              \x3c!--Actions--\x3e\n              <td class="uip-padding-top-xs uip-padding-bottom-xs uip-border-bottom uip-text-right">\n                <div class="uip-inline-flex" @click.prevent.stop="$refs[\'userMenu-\'+index][0].show($event)">\n                  <a class="uip-link-default hover:uip-background-muted uip-border-rounder uip-icon uip-padding-xxs">more_vert</a>\n                </div>\n              </td>\n              \n            \n            </tr>\n            \n          </TransitionGroup>  \n        \n        </table>\n        \n        <div class="uip-padding-bottom-s uip-border-bottom uip-flex uip-flex-between uip-flex-center">\n          \n          <div class="uip-text-muted">\n            {{query.totalUsers}} {{strings.results}}\n          </div>\n          \n          <div class="uip-flex uip-gap-xs uip-text-s">\n          \n            <button :disabled="tableFilters.page < 2" class="uip-button-default" @click="tableFilters.page--">{{strings.previous}}</button>\n            <button :disabled="tableFilters.page >= query.totalPages" class="uip-button-default" @click="tableFilters.page++">{{strings.next}}</button>\n          \n          </div>\n        \n        \n        </div>\n      \n      \n      </div>\n      \n      \n      <template v-for="(user, index) in returnUsers">\n        <ContextMenu :ref="\'userMenu-\'+index">\n        \n          <div class="uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal uip-text-s">\n          \n            <router-link :to="\'/users/\' + user.user_id + \'/\'" @click="$refs[\'userMenu-\'+index][0].close()" \n            class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n              <span class="">{{strings.view}}</span>\n              <span class="uip-icon">visibility</span>\n            </router-link>\n          \n            <router-link :to="\'/users/\' + user.user_id + \'/edit\'" @click="$refs[\'userMenu-\'+index][0].close()" \n            class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n              <span class="">{{strings.edit}}</span>\n              <span class="uip-icon">edit</span>\n            </router-link>\n            \n            <a @click="sendPasswordReset(user.user_id);$refs[\'userMenu-\'+index][0].close()" \n            class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n              <span class="">{{strings.passwordReset}}</span>\n              <span class="uip-icon">lock</span>\n            </a>\n            \n            <a @click="uipApp.messageUser.show(user);$refs[\'userMenu-\'+index][0].close()" \n            class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n              <span class="">{{strings.message}}</span>\n              <span class="uip-icon">mail</span>\n            </a>\n            \n            \n            <div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs"></div>\n            \n            <a class="uip-link-danger uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n            @click.prevent="deleteUser(user.user_id);$refs[\'userMenu-\'+index][0].close()">\n              <span class="">{{strings.delete}}</span>\n              <span class="uip-icon">delete</span>\n            </a>\n          \n          </div>\n        \n        </ContextMenu>\n      </template>\n      \n      <Confirm ref="Confirm"/>\n    \n  \n        \n        '};