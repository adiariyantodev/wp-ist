const{__:__,_x:_x,_n:_n,_nx:_nx}=wp.i18n;export default{props:{closePanel:Function,sendmessage:Function,groups:Object},data(){return{strings:{previous:__("Previous","uipress-pro"),next:__("Next","uipress-pro"),results:__("results","uipress-pro"),details:__("Details","uipress-pro"),editUser:__("Edit user","uipress-pro"),passwordReset:__("Send password reset","uipress-pro"),sendMessage:__("Send message","uipress-pro"),logoutEverywhere:__("Logout everywhere","uipress-pro"),edit:__("Edit","uipress-pro"),delete:__("Delete user","uipress-pro"),name:__("Name","uipress-pro"),email:__("Email","uipress-pro"),accountCreated:__("Account created","uipress-pro"),lastLogin:__("Last login","uipress-pro"),lastLoginCountry:__("Login location","uipress-lite"),totalPosts:__("Total posts","uipress-lite"),totalComments:__("Total commends","uipress-lite"),userNotes:__("User notes","uipress-lite"),recentPageViews:__("Recent page views","uipress-lite"),noActivity:__("No activity","uipress-lite"),recentActivity:__("Recent activity","uipress-lite"),role:__("Role","uipress-lite")},userID:this.$route.params.id,panelData:[],userFetched:!1,recentActivity:{page:1,totalPages:0},user:{editData:[]},ui:{editing:!1,activityOpen:!0,pageViewsOpen:!0,userNotesOpen:!0}}},async mounted(){this.getUserData(),this.$route.params.id&&void 0!==this.$route.params.id||this.$router.push("/")},methods:{async getUserData(){let e=new FormData;e.append("action","uip_get_user_data"),e.append("security",this.AjaxSecurity),e.append("userID",this.$route.params.id),e.append("activityPage",JSON.stringify(this.recentActivity.page));const i=await this.sendServerRequest(this.AjaxUrl,e);i.error?this.uipApp.notifications.notify(i.error,"","error",!0):(this.panelData=i,this.userFetched=!0,this.recentActivity.totalPages=this.panelData.history.totalPages,this.user.editData=JSON.parse(JSON.stringify(this.panelData.user)))},async sendPasswordReset(){const e=[this.panelData.user.user_id];let i=new FormData;i.append("action","uip_reset_password"),i.append("security",this.AjaxSecurity),i.append("IDS",JSON.stringify(e));const t=await this.sendServerRequest(this.AjaxUrl,i);t.error?this.uipApp.notifications.notify(t.message,"","error",!0):this.uipApp.notifications.notify(t.message,"","success",!0)},async deleteUser(){if(!await this.$refs.Confirm.show({title:__("Delete user","uipress-pro"),message:__("Deleted users can't be recovered","uipress-pro"),okButton:__("Delete","uipress-pro")}))return;let e=new FormData;e.append("action","uip_delete_user"),e.append("security",this.AjaxSecurity),e.append("userID",this.panelData.user.user_id);const i=await this.sendServerRequest(this.AjaxUrl,e);i.error?this.uipApp.notifications.notify(i.message,"","error",!0):(this.uipApp.notifications.notify(i.message,"","success",!0),this.uipApp.refreshTable(),this.$router.push("/"))},async logoutEverywhere(){let e=new FormData;e.append("action","uip_logout_user_everywhere"),e.append("security",this.AjaxSecurity),e.append("userID",this.panelData.user.user_id);const i=await this.sendServerRequest(this.AjaxUrl,e);i.error?this.uipApp.notifications.notify(i.message,"","error",!0):this.uipApp.notifications.notify(i.message,"","success",!0)},changeActivityPage(e){"next"==e&&this.recentActivity.page++,"previous"==e&&(this.recentActivity.page=this.recentActivity.page--),this.getUserData()},returnViewTitle:e=>e.title?e.title:e.url,returnFormattedLink(e){try{return this.stripUIPparams(e)}catch(i){return e}}},template:' \n  \n      <FloatingPanel ref="userPanel" :startOpen="true" :closer="()=>$router.push(\'/\')">\n        \n        \n        <div class="uip-flex uip-flex-grow uip-flex-column uip-max-h-100p uip-row-gap-s uip-padding-m" v-if="userFetched">\n        \n        \n          <div class="uip-flex uip-flex-column uip-row-gap-xs" >\n            \n            \x3c!-- OVERVIEW --\x3e\n            <div class="uip-flex uip-flex-center uip-gap-s">\n            \n              <div class="">\n                <img :src="panelData.user.image" class="uip-border-circle uip-w-38 uip-ratio-1-1">\n              </div>\n              \n              <div class="uip-flex uip-flex-column uip-flex-grow">\n                <div class="uip-text-bold uip-text-l uip-text-emphasis">{{panelData.user.username}}</div>\n                <div class="uip-text-muted uip-max-w-250 uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.user_email}}</div>\n              </div>\n              \n              <div class="uip-flex uip-text-l uip-self-flex-start">\n                \n                \x3c!-- Edit dropdown--\x3e\n                <dropdown pos="left top" ref="userOptions">\n                  <template #trigger>\n                    <a class="uip-link-muted hover:uip-background-muted uip-border-rounder uip-icon uip-padding-xxs">more_vert</a>\n                  </template>\n                  <template #content>\n                   \n                   \n                   <div class="uip-padding-xs uip-flex uip-flex-column uip-text-weight-normal uip-text-s">\n                   \n                    <router-link :to="\'/users/\' + panelData.user.user_id + \'/edit\'"\n                    class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                      <span class="">{{strings.edit}}</span>\n                      <span class="uip-icon">edit</span>\n                    </router-link>\n                    \n                    <router-link :to="\'/message/\' + panelData.user.user_email" class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                      <div>{{strings.sendMessage}}</div>\n                      <div class="uip-icon">email</div>\n                    </router-link>\n                    \n                    <a @click="sendPasswordReset();$refs.userOptions.close()" \n                    class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                      <span class="">{{strings.passwordReset}}</span>\n                      <span class="uip-icon">lock</span>\n                    </a>\n                    \n                    <a @click="logoutEverywhere();$refs.userOptions.close()" class="uip-link-default uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder uip-no-underline">\n                      <div>{{strings.logoutEverywhere}}</div>\n                      <div class="uip-icon">logout</div>\n                    </a>\n                    \n                    <div class="uip-border-top uip-margin-top-xs uip-margin-bottom-xs"></div>\n                    \n                    <a class="uip-link-danger uip-flex uip-flex-center uip-flex-between uip-gap-m uip-padding-xxs hover:uip-background-muted uip-border-rounder"\n                    @click.prevent="deleteUser();$refs.userOptions.close()">\n                      <span class="">{{strings.delete}}</span>\n                      <span class="uip-icon">delete</span>\n                    </a>\n                   \n                   </div>\n                    \n                   \n                  </template>\n                </dropdown>\n                \n                <a @click="$router.push(\'/\');$refs.userPanel.close()" class="uip-link-muted hover:uip-background-muted uip-border-rounder uip-icon uip-padding-xxs">close</a>\n                \n              </div>\n            </div>\n            \n          </div>\n          \n          \x3c!--Spacer--\x3e\n          <div class=""></div>\n          \n          \x3c!--User details--\x3e\n          <ToggleSection :title="strings.details" :startOpen="true">\n          \n            <div class="uip-grid-col-1-3">\n                  \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.role}}</span>\n              </div>\n              <div class="uip-flex uip-gap-xs uip-flex-wrap uip-flex-right">\n                <router-link :to="\'/roles/edit/\' + role" v-for="role in panelData.user.roles" \n                class="uip-background-primary-wash uip-border-round uip-padding-left-xxs uip-padding-right-xxs uip-text-bold uip-link-default uip-no-underline uip-text-s">\n                  {{role}}\n                </router-link>\n              </div>\n                \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.name}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.name}}</div>\n              \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.email}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.user_email}}</div>\n              \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.accountCreated}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.user_registered}}</div>\n                \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.lastLogin}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.uip_last_login_date}}</div>\n              \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.lastLoginCountry}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.uip_last_login_country}}</div>\n              \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.totalPosts}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.totalPosts}}</div>\n              \n              <div class="uip-text-muted uip-flex uip-flex-center uip-gap-xs">\n                <span>{{strings.totalComments}}</span>\n              </div>\n              <div class="uip-text-right uip-max-w-100p uip-overflow-hidden uip-no-wrap uip-text-ellipsis">{{panelData.user.totalComments}}</div>\n              \n            </div>\n          \n          </ToggleSection>\n          \x3c!--End user details--\x3e\n          \n          <div class="uip-border-top"></div>\n          \n          \n          \x3c!--Recent page views--\x3e\n          <ToggleSection :title="strings.recentPageViews" :startOpen="false">\n          \n            <div v-if="!panelData.recentPageViews.length">{{strings.noActivity}}</div>\n            \n            <table v-else class="uip-border-collapse">\n              <tbody>\n                <tr v-for="(view, index) in panelData.recentPageViews">\n                \n                  <td class="uip-no-wrap uip-text-right uip-vertical-align-top">\n                    <div class="uip-text-muted  uip-text-s">{{view.human_time}}</div>\n                  </td>\n                  \n                  \n                  <td class="uip-h-12 uip-w-12 uip-no-wrap uip-padding-left-s uip-padding-right-s uip-padding-top-xs">\n                    <div class="uip-h-100p uip-position-relative uip-flex uip-flex-column uip-flex-center uip-row-gap-xs">\n                    \n                      <div class="uip-w-4 uip-h-4 uip-border-circle uip-background-primary"></div>\n                      \n                      <div v-if="index != panelData.recentPageViews.length - 1" class="uip-background-muted uip-w-2 uip-flex uip-flex-middle uip-overflow-visible uip-flex-grow uip-flex-start">\n                        \n                      </div>\n                    </div>\n                  </td>\n                  \n                  <td class="uip-w-90p uip-padding-bottom-s uip-vertical-align-top">\n                    <a class="uip-link-muted uip-text-bold uip-text-normal uip-no-underline" :href="returnFormattedLink(view.url)">{{returnViewTitle(view)}}</a>\n                  </td>\n                \n                </tr>\n              </tbody>\n            </table>\n          \n          </ToggleSection>\n          \n          <div class="uip-border-top"></div>\n          \n          \x3c!--Recent activity--\x3e\n          <ToggleSection :title="strings.recentActivity" :startOpen="false">\n          \n            <div v-if="panelData.history.totalFound == 0">{{strings.noActivity}}</div>\n              \n            <table v-else class="uip-border-collapse">\n              <tbody>\n                <tr v-for="(view, index) in panelData.history.list">\n                \n                  <td class="uip-no-wrap uip-text-right uip-vertical-align-top">\n                    <div class="uip-text-muted  uip-text-s">{{view.human_time}}</div>\n                  </td>\n                  \n                  <td class="uip-h-12 uip-w-12 uip-no-wrap uip-padding-left-s uip-padding-right-s uip-padding-top-xs">\n                    <div class="uip-h-100p uip-position-relative uip-flex uip-flex-column uip-flex-center uip-row-gap-xs">\n                    \n                      <div class="uip-w-4 uip-h-4 uip-border-circle"\n                      :class="[{\'uip-background-primary\' : view.type == \'primary\'}, {\'uip-background-orange\' : view.type == \'warning\'}, {\'uip-background-red\' : view.type == \'danger\'}]"></div>\n                      \n                      <div v-if="index != panelData.history.list.length - 1" class="uip-background-muted uip-w-2 uip-flex uip-flex-middle uip-overflow-visible uip-flex-grow uip-flex-start">\n                        \n                      </div>\n                    </div>\n                  </td>\n                  \n                  <td class="uip-w-90p">\n                    <div class="uip-padding-bottom-xs">\n                      <div class="uip-text-bold uip-text-normal uip-no-underline" >{{view.title}}</div>\n                      <div class="uip-text-muted uip-text-s" v-html="view.meta"></div>\n                      <div class="uip-flex uip-gap-xxs uip-text-s" >\n                        <template v-for="link in view.links">\n                          <a :href="returnFormattedLink(link.url)" class="uip-link-muted uip-link-no-underline">{{link.name}}</a>\n                        </template>\n                      </div>\n                    </div>\n                  </td>\n                \n                </tr>\n              </tbody>\n            </table>\n              \n            \n            <div class="uip-flex uip-gap-xs uip-margin-top-s" v-if="recentActivity.totalPages > 1">\n              <button v-if="recentActivity.page > 1" class="uip-button-default" @click="changeActivityPage(\'previous\')">{{strings.previous}}</button>\n              <button class="uip-button-default" @click="changeActivityPage(\'next\')">{{strings.next}}</button>\n            </div>\n          \n          </ToggleSection>\n            \n          <div class="uip-border-top"></div>  \n          \n        </div>\n        \n        <Confirm ref="Confirm"/>\n        \n      </FloatingPanel>'};